<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Taraftarium24 - Canlı Maç Keyfi</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <style>
        /* Google Fonts */
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap');

        /* --- CSS Variables --- */
        :root { /* Koyu Tema */
            --sidebar-width: 260px;
            --bg-primary: #16161a;
            --bg-secondary: #222226;
            --bg-sidebar: rgba(22, 22, 26, 0.88);
            --bg-sidebar-fallback: #16161a;
            --text-primary: #e8e8ed;
            --text-secondary: #94a3b8;
            --border-color: rgba(203, 213, 225, 0.18);
            --shadow-color: rgba(0, 0, 0, 0.8);
            --primary-accent: #8B5CF6;
            --secondary-accent: #A78BFA;
            --live-color: #F87171;
            --hover-bg-light: rgba(139, 92, 246, 0.18);
            --table-header-bg: linear-gradient(to bottom, #38383d, #222226);
            --button-hover-bg: var(--secondary-accent);
            --scrollbar-thumb: var(--primary-accent);
            --scrollbar-track: rgba(255, 255, 255, 0.08);
            --shadow-accent-color: rgba(139, 92, 246, 0.45);
        }
        body.light-theme { /* Açık Tema */
            --bg-primary: #f8fafc;
            --bg-secondary: #ffffff;
            --bg-sidebar: rgba(248, 250, 252, 0.9);
            --bg-sidebar-fallback: #f8fafc;
            --text-primary: #0f172a;
            --text-secondary: #475569;
            --border-color: #cbd5e1;
            --shadow-color: rgba(15, 23, 42, 0.18);
            --primary-accent: #7c3aed;
            --secondary-accent: #a78bfa;
            --live-color: #ef4444;
            --hover-bg-light: rgba(124, 58, 237, 0.08);
            --table-header-bg: linear-gradient(to bottom, #f1f5f9, #e5e7eb);
            --button-hover-bg: var(--secondary-accent);
            --scrollbar-thumb: var(--primary-accent);
            --scrollbar-track: #e5e7eb;
            --shadow-accent-color: rgba(124, 58, 237, 0.22);
        }

        /* Genel */
        html { box-sizing: border-box; scroll-behavior: smooth; }
        *, *:before, *:after { box-sizing: inherit; }
        body { margin: 0; padding: 0; min-height: 100vh; font-family: 'Poppins', sans-serif; color: var(--text-primary); background-color: var(--bg-primary); display: flex; transition: padding-left 0.35s cubic-bezier(0.4, 0, 0.2, 1), background-color 0.3s ease, color 0.3s ease; font-size: 16px; line-height: 1.6; overflow-x: hidden; }
        *:focus-visible { outline: 3px solid var(--secondary-accent); outline-offset: 4px; box-shadow: 0 0 0 6px var(--shadow-accent-color); border-radius: 8px; }

        /* Tema Değiştirici */
        #theme-toggle { position: fixed; top: 18px; right: 22px; background: var(--bg-secondary); color: var(--primary-accent); border: 1px solid var(--border-color); width: 48px; height: 48px; border-radius: 50%; cursor: pointer; z-index: 1002; display: flex; align-items: center; justify-content: center; font-size: 22px; box-shadow: 0 4px 15px var(--shadow-color); transition: all 0.35s cubic-bezier(0.25, 0.1, 0.25, 1); }
        #theme-toggle:hover { background-color: var(--primary-accent); color: white; transform: translateY(-3px) scale(1.1); box-shadow: 0 7px 20px var(--shadow-accent-color); }
        #theme-toggle .fa-sun { display: none; } body.light-theme #theme-toggle .fa-sun { display: inline-block; } body.light-theme #theme-toggle .fa-moon { display: none; }

        /* Sidebar */
        #sidebar { width: var(--sidebar-width); background-color: var(--bg-sidebar); -webkit-backdrop-filter: blur(16px); backdrop-filter: blur(16px); @supports not ((-webkit-backdrop-filter: none) or (backdrop-filter: none)) { background-color: var(--bg-sidebar-fallback); } padding: 25px 15px; box-sizing: border-box; height: 100vh; position: fixed; left: 0; top: 0; display: flex; flex-direction: column; overflow-y: auto; transition: width 0.35s cubic-bezier(0.4, 0, 0.2, 1), padding 0.35s cubic-bezier(0.4, 0, 0.2, 1), transform 0.35s cubic-bezier(0.4, 0, 0.2, 1), background-color 0.3s ease; z-index: 1000; border-right: 1px solid var(--border-color); box-shadow: 7px 0 35px var(--shadow-color); }
        #sidebar::-webkit-scrollbar { width: 8px; } #sidebar::-webkit-scrollbar-thumb { background: var(--scrollbar-thumb); border-radius: 8px; border: 2px solid transparent; background-clip: content-box;} #sidebar::-webkit-scrollbar-track { background: transparent; }
        #sidebar h3 { color: var(--secondary-accent); text-align: center; margin: 15px 0 35px 0; font-weight: 600; font-size: 1.4em; white-space: nowrap; opacity: 1; transition: opacity 0.2s ease; letter-spacing: 1.3px; display: flex; align-items: center; justify-content: center; gap: 12px; }
        .channel-list { list-style: none; padding: 0 5px; margin: 0; flex-grow: 1; }
        .channel-list li a { display: flex; align-items: center; justify-content: space-between; gap: 15px; padding: 15px 20px; color: var(--text-secondary); text-decoration: none; border-radius: 12px; margin-bottom: 12px; font-size: 1.05em; font-weight: 500; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; transition: background-color 0.2s ease, color 0.2s ease, transform 0.2s ease, box-shadow 0.2s ease, border-color 0.2s ease; position: relative; overflow: visible; border: 1px solid transparent; }
        .channel-list li a .channel-name { display: flex; align-items: center; gap: 15px; overflow: hidden; text-overflow: ellipsis;}
        .channel-list li a::before { content: ''; position: absolute; left: 0; top: 0; width: 5px; height: 100%; background-color: var(--primary-accent); transform: scaleY(0); transform-origin: center; transition: transform 0.25s ease; border-top-right-radius: 5px; border-bottom-right-radius: 5px; }
        .channel-list li a i { width: 24px; text-align: center; color: var(--secondary-accent); transition: color 0.2s ease, transform 0.2s ease; font-size: 1.15em; flex-shrink: 0; }
        .channel-list li a:hover { background-color: var(--hover-bg-light); color: var(--text-primary); transform: translateX(7px); box-shadow: 0 4px 12px rgba(0,0,0, 0.12); border-color: var(--border-color); }
        .channel-list li a:hover::before { transform: scaleY(0.85); } .channel-list li a:hover i { color: var(--primary-accent); transform: scale(1.15); }
        .channel-list li a.active { background-color: var(--primary-accent); color: white; font-weight: 600; box-shadow: 0 6px 18px var(--shadow-accent-color); transform: translateX(0); border-color: var(--primary-accent); }
        .channel-list li a.active::before { transform: scaleY(1); } .channel-list li a.active i { color: white; transform: scale(1); }
         /* Live Indicator */
         .live-indicator { width: 10px; height: 10px; background-color: var(--live-color); border-radius: 50%; display: inline-block; box-shadow: 0 0 8px var(--live-color); opacity: 0; transition: opacity 0.3s ease; animation: pulseLive 1.4s infinite ease-in-out; flex-shrink: 0; margin-left: auto; }
         .channel-list li a.has-live .live-indicator { opacity: 1; }
         @keyframes pulseLive { 0%, 100% { transform: scale(0.85); opacity: 0.7; } 50% { transform: scale(1.15); opacity: 1; } }

        /* Sidebar Toggle */
        #sidebar-toggle { position: fixed; top: 18px; left: var(--sidebar-width); background-color: var(--primary-accent); color: white; border: none; width: 38px; height: 55px; cursor: pointer; z-index: 1001; border-top-right-radius: 12px; border-bottom-right-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 24px; box-shadow: 4px 0 15px var(--shadow-color); transition: left 0.35s cubic-bezier(0.4, 0, 0.2, 1), background-color 0.3s ease, transform 0.2s ease; }
        #sidebar-toggle:hover { background-color: var(--button-hover-bg); transform: scale(1.08) translateX(-3px); }

        /* Collapsed Sidebar */
        body.sidebar-collapsed #sidebar { width: 0; padding: 25px 0; transform: translateX(calc(-1 * var(--sidebar-width))); overflow: hidden; box-shadow: none; border-right: none; backdrop-filter: none; -webkit-backdrop-filter: none; background-color: transparent;}
        body.sidebar-collapsed #sidebar h3, body.sidebar-collapsed .channel-list { opacity: 0; pointer-events: none; }
        body.sidebar-collapsed #sidebar-toggle { left: 0; } body.sidebar-collapsed #main-content { margin-left: 0; }

        /* Main Content */
        #main-content { flex-grow: 1; margin-left: var(--sidebar-width); padding: 0; transition: margin-left 0.35s cubic-bezier(0.4, 0, 0.2, 1); display: flex; flex-direction: column; height: 100dvh; overflow-y: auto; position: relative; }
        #main-content::-webkit-scrollbar { width: 10px; } #main-content::-webkit-scrollbar-thumb { background: var(--scrollbar-thumb); border-radius: 10px; border: 2px solid var(--bg-primary); background-clip: padding-box;} #main-content::-webkit-scrollbar-track { background: color-mix(in srgb, var(--bg-primary) 75%, black); }
        .container { display: flex; flex-direction: column; align-items: center; text-align: center; padding: 35px 35px 50px 35px; width: 100%; max-width: 1450px; box-sizing: border-box; flex-grow: 1; margin: 0 auto; opacity: 0; animation: fadeInContainer 0.7s 0.1s ease-out forwards; }
        @keyframes fadeInContainer { to { opacity: 1; transform: translateY(0);} from { opacity: 0; transform: translateY(15px); } }

        /* Logo */
        .logo { max-width: 150px; margin-bottom: 20px; transition: transform 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275), filter 0.4s ease; border-radius: 50%; filter: drop-shadow(0px 8px 20px var(--shadow-accent-color)); cursor: pointer; }
        .logo:hover { transform: scale(1.2) rotate(10deg); filter: drop-shadow(0px 12px 30px var(--shadow-accent-color)); }

        /* Başlık ve Tarih */
        h1 { font-size: clamp(32px, 6vw, 48px); font-weight: 700; margin-bottom: 8px; background: linear-gradient(90deg, var(--secondary-accent), var(--primary-accent)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; text-fill-color: transparent; text-transform: uppercase; letter-spacing: 5px; text-shadow: 1px 1px 8px rgba(0, 0, 0, 0.4); transition: filter 0.3s ease, letter-spacing 0.3s ease; }
        h1:hover { filter: brightness(1.4); letter-spacing: 6px;}
        #current-date { font-size: 0.95em; color: var(--text-secondary); margin-bottom: 35px; font-weight: 500; letter-spacing: 0.5px; }

        /* Stream Area */
        .stream-area-wrapper { width: 100%; max-width: 1200px; margin: 0 auto 45px auto; position: relative; }
        .stream-container { width: 100%; position: relative; height: 0; padding-top: 56.25%; border-radius: 20px; overflow: hidden; border: 4px solid var(--primary-accent); background-color: #000; box-shadow: 0 16px 40px var(--shadow-color); transition: all 0.35s ease; }
        .stream-container iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: none; }
        .stream-container:hover { box-shadow: 0 20px 50px var(--shadow-color), 0 0 35px var(--shadow-accent-color); border-color: var(--secondary-accent);}

        /* Iframe Loader */
        .iframe-loader { position: absolute; inset: 0; background-color: rgba(0, 0, 0, 0.75); display: flex; align-items: center; justify-content: center; z-index: 20; opacity: 0; visibility: hidden; transition: opacity 0.3s ease, visibility 0.3s ease; backdrop-filter: blur(3px); }
        .iframe-loader.loading { opacity: 1; visibility: visible; }
        .iframe-loader .spinner { width: 50px; height: 50px; border-width: 5px; margin: 0; animation: spin 1s linear infinite; border: 5px solid rgba(255, 255, 255, 0.2); border-top-color: var(--primary-accent); border-radius: 50%; }

        /* Fullscreen Button */
        #fullscreen-btn { position: absolute; bottom: 18px; right: 18px; background-color: rgba(20, 20, 20, 0.75); color: #e0e0e0; border: 1px solid rgba(255,255,255,0.2); width: 45px; height: 45px; border-radius: 12px; cursor: pointer; z-index: 21; display: flex; align-items: center; justify-content: center; font-size: 20px; opacity: 0.8; transition: all 0.3s ease; backdrop-filter: blur(5px); }
        #fullscreen-btn:hover { opacity: 1; background-color: rgba(0, 0, 0, 0.9); transform: scale(1.1); color: white;}

        /* Ana Yükleme Göstergesi */
        #loading-indicator { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background-color: var(--bg-primary); display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 1100; color: var(--text-primary); visibility: visible; opacity: 1; transition: opacity 0.5s 0.1s ease, visibility 0.5s 0.1s ease; }
        #loading-indicator.hidden { opacity: 0; visibility: hidden; pointer-events: none; }
        .spinner { width: 70px; height: 70px; border: 8px solid rgba(255, 255, 255, 0.2); border-top-color: var(--primary-accent); border-radius: 50%; animation: spin 1.1s linear infinite; margin-bottom: 28px; }
        #loading-indicator p { font-size: 1.2em; font-weight: 500; letter-spacing: 0.8px;}
        @keyframes spin { to { transform: rotate(360deg); } }

        /* Section Title */
        h2 { font-size: clamp(24px, 5vw, 34px); color: var(--text-primary); margin: 0 0 25px 0; font-weight: 600; text-shadow: 1px 1px 7px rgba(0,0,0,0.3); display: flex; align-items: center; justify-content: center; gap: 15px; border-bottom: 3px solid; border-image-slice: 1; border-image-source: linear-gradient(to left, var(--primary-accent), var(--secondary-accent)); padding-bottom: 12px; }
        h2 i { color: var(--secondary-accent); opacity: 0.95; }

        /* Filter Section */
        .filter-section { display: flex; flex-direction: column; align-items: center; gap: 15px; width: 100%; margin-bottom: 25px; }
        .filter-container { width: 100%; max-width: 750px; position: relative; }
        .filter-container i { position: absolute; left: 22px; top: 50%; transform: translateY(-50%); color: var(--text-secondary); font-size: 1.1em; pointer-events: none; transition: color 0.3s ease; }
        #matchFilter:focus + i { color: var(--primary-accent); }
        #matchFilter { width: 100%; padding: 16px 28px 16px 65px; border-radius: 14px; border: 1px solid var(--border-color); background-color: var(--bg-secondary); color: var(--text-primary); font-size: 1.1em; transition: all 0.3s ease; }
        #matchFilter:focus { outline: none; border-color: var(--primary-accent); box-shadow: 0 0 18px var(--shadow-accent-color); background-color: color-mix(in srgb, var(--bg-secondary) 92%, black); }
        #filter-results-count { font-size: 1em; color: var(--text-secondary); height: 1.4em; transition: opacity 0.3s ease; text-align: center; width: 100%; max-width: 750px; margin-top: 5px; }

        /* İki Sütunlu Tablo Yerleşimi */
        .tables-container { width: 100%; display: grid; grid-template-columns: 1fr; gap: 35px; margin-top: 30px; margin-bottom: 50px; }
        /* --- GRID LAYOUT GÜNCELLENDİ (min-width: 1024px) --- */
        @media (min-width: 1024px) {
            .tables-container {
                grid-template-columns: minmax(550px, 1.7fr) minmax(400px, 1fr); /* İki sütun */
                gap: 45px;
                align-items: start; /* Öğeleri yukarı hizala */
            }
            /* Sol Sütun Öğeleri */
            #announcements-section,
            .filter-section,
            #match-schedule-section {
                grid-column: 1 / 2; /* Hepsi 1. sütunda */
                padding-right: calc(45px / 2); /* Sağ boşluk (çizgi için) */
            }
             /* Sağ Sütun Öğesi */
            #league-table-section {
                grid-column: 2 / 3; /* 2. sütunda */
                grid-row: 1 / 4; /* Sol sütundaki 3 öğenin yüksekliğini kapla */
            }

            #league-table-section h2,
            #announcements-section h2 {
                 margin-top: 0; /* Sağ sütun ve duyuru başlığı için üst boşluğu sıfırla */
            }

             /* Sütunlar arası çizgi (Maç programı ile Puan durumu arasına) */
             #match-schedule-section {
                 position: relative;
                 /* padding-right zaten yukarıda tanımlı */
             }
             #match-schedule-section::after {
                 content: '';
                 position: absolute;
                 right: 0;
                 top: 5%;
                 bottom: 5%;
                 width: 1px;
                 background-color: var(--border-color);
                 opacity: 0.6;
             }
        }
        @media (min-width: 1400px) {
            .tables-container { gap: 55px; }
            #announcements-section,
            .filter-section,
            #match-schedule-section { padding-right: calc(55px / 2); }
        }
        /* --- GRID LAYOUT GÜNCELLEMESİ SONU --- */


        /* Tablo Wrapper */
        .match-table-wrapper, .league-table-wrapper {
            width: 100%; overflow: visible;
            border-radius: 20px; box-shadow: 0 14px 45px var(--shadow-color);
            border: 1px solid var(--border-color); background: var(--bg-secondary);
            transition: all 0.3s ease; display: flex; flex-direction: column;
        }
        /* TABLO İÇERİĞİ KAYDIRMA */
        .table-content {
            overflow-x: auto; /* Sadece yatay kaydırma */
            -webkit-overflow-scrolling: touch; /* Mobil için yumuşak kaydırma */
        }
        /* Kaydırma çubuğu stilleri (isteğe bağlı) */
        .table-content::-webkit-scrollbar { height: 8px; }
        .table-content::-webkit-scrollbar-thumb { background: var(--scrollbar-thumb); border-radius: 8px; border: 2px solid var(--bg-secondary); background-clip: padding-box; }
        .table-content::-webkit-scrollbar-track { background: color-mix(in srgb, var(--bg-secondary) 85%, black); border-radius: 8px; }


        /* Match Table */
        .match-table { width: 100%; border-collapse: collapse; color: var(--text-primary); min-width: 620px; /* Tekrar biraz azaltıldı */ }
        .match-table th, .match-table td { text-align: left; padding: 14px 15px; font-size: clamp(13.5px, 1.7vw, 14.5px); white-space: nowrap; border-bottom: 1px solid var(--border-color); transition: border-color 0.3s ease; }
        .match-table td { color: var(--text-secondary); font-weight: 400; transition: color 0.3s ease; }
        .match-table th { background: var(--table-header-bg); font-weight: 600; text-transform: uppercase; letter-spacing: 1.3px; position: sticky; top: 0; z-index: 5; border-bottom: 3px solid var(--primary-accent); color: var(--text-primary); text-align: left; transition: all 0.3s ease; }
        .match-table tbody tr:last-child td { border-bottom: none; }
        .match-table tbody tr { transition: background-color 0.25s ease, border-left-color 0.25s ease, opacity 0.5s ease, transform 0.5s ease; border-left: 4px solid transparent; opacity: 0; transform: translateY(15px); }
        .match-table tbody tr.visible { opacity: 1; transform: translateY(0); }
        .match-table tbody tr:hover { background-color: var(--hover-bg-light); border-left-color: var(--secondary-accent); }
        .match-table td strong { color: var(--text-primary); font-weight: 500; transition: color 0.3s ease; }
        .highlights-btn { background-color: color-mix(in srgb, var(--bg-secondary) 80%, var(--text-secondary)); color: var(--text-secondary); border: 1px solid var(--border-color); padding: 7px 10px; border-radius: 8px; cursor: not-allowed; font-weight: 400; font-size: 0.85em; opacity: 0.6; margin-left: 10px; transition: all 0.2s ease; }
        .highlights-btn i { margin-right: 3px; }
        .highlights-btn:hover { opacity: 0.8; }

        /* Status & Live Row */
        .status-icon { margin-right: 10px; font-size: 1em; opacity: 0.9; vertical-align: middle; }
        .status-live { color: var(--live-color); font-weight: 600; }
        .status-upcoming { color: var(--secondary-accent); }
        .countdown-timer { font-size: 0.8em; color: var(--text-secondary); margin-left: 8px; font-style: italic; opacity: 0.8; }
        .match-row.live { border-left: 4px solid var(--live-color); background-color: rgba(248, 113, 113, 0.07); } body.light-theme .match-row.live { background-color: rgba(239, 68, 68, 0.07); }
        .match-row.live td { color: var(--text-primary); font-weight: 500; }
        .match-row.live td strong { font-weight: 700; }
        .match-row.live:hover { background-color: rgba(248, 113, 113, 0.14); border-left-color: var(--live-color); } body.light-theme .match-row.live:hover { background-color: rgba(239, 68, 68, 0.14); }

        /* Stream Button */
        .stream-button { background-image: linear-gradient(to right, var(--primary-accent) 0%, var(--secondary-accent) 51%, var(--primary-accent) 100%); background-size: 200% auto; color: #fff; border: none; padding: 10px 18px; border-radius: 10px; cursor: pointer; font-weight: 500; font-size: 1em; display: inline-flex; align-items: center; gap: 8px; transition: all 0.4s ease; box-shadow: 0 3px 8px rgba(0,0,0,0.25); }
        .stream-button:hover { background-position: right center; transform: translateY(-3px) scale(1.06); box-shadow: 0 6px 18px var(--shadow-accent-color); }
        .stream-button i { transition: transform 0.3s ease; } .stream-button:hover i { transform: rotate(12deg) scale(1.1); }

        /* League Table */
        #league-table-section { /* Konumlandırma grid ile */ }
        #league-table-section h2 { /* Stilleri miras alır */ }
        .league-table { width: 100%; border-collapse: collapse; color: var(--text-primary); min-width: 420px; /* Biraz azaltıldı */ }
        .league-table th, .league-table td { text-align: center; padding: 15px 8px; font-size: clamp(13.5px, 1.8vw, 15px); border-bottom: 1px solid var(--border-color); white-space: nowrap; transition: border-color 0.3s ease; }
        .league-table td:nth-child(2) { text-align: left; padding-left: 15px; }
        .league-table th { background: var(--table-header-bg); font-weight: 600; text-transform: uppercase; letter-spacing: 1px; position: sticky; top: 0; z-index: 5; border-bottom: 3px solid var(--primary-accent); transition: all 0.3s ease;}
        .league-table tbody tr:nth-child(odd) { background-color: rgba(255, 255, 255, 0.02); transition: background-color 0.3s ease;} body.light-theme .league-table tbody tr:nth-child(odd) { background-color: rgba(0, 0, 0, 0.015); }
        .league-table tbody tr:hover { background-color: var(--hover-bg-light); }
        .league-table td.rank { font-weight: 700; color: var(--secondary-accent); width: 50px;}
        .league-table td.team { font-weight: 500; }
        .league-table td.points { font-weight: 700; color: var(--text-primary); }

        /* Footer */
        .footer { font-size: 0.95em; color: var(--text-secondary); padding: 35px 20px; background-color: var(--bg-sidebar); text-align: center; width: 100%; box-sizing: border-box; border-top: 1px solid var(--border-color); margin-top: auto; transition: all 0.3s ease; }
        .footer p { margin: 0; letter-spacing: 0.5px; }
        .footer a { color: var(--secondary-accent); text-decoration: none; font-weight: 500; transition: color 0.2s ease; margin: 0 5px; }
        .footer a:hover { color: var(--primary-accent); text-decoration: underline; }

        /* Go To Top Button */
        #goToTopBtn { position: fixed; bottom: 30px; right: 30px; background-color: var(--primary-accent); color: white; border: none; width: 50px; height: 50px; border-radius: 50%; cursor: pointer; z-index: 1001; display: flex; align-items: center; justify-content: center; font-size: 24px; box-shadow: 0 5px 15px var(--shadow-color); opacity: 0; visibility: hidden; transform: translateY(20px) scale(0.8); transition: all 0.35s cubic-bezier(0.25, 0.1, 0.25, 1); }
        #goToTopBtn.visible { opacity: 1; visibility: visible; transform: translateY(0) scale(1); }
        #goToTopBtn:hover { background-color: var(--button-hover-bg); transform: scale(1.15); box-shadow: 0 8px 22px var(--shadow-accent-color); }

        /* Responsive */
         @media (max-width: 1023px) {
             .tables-container { grid-template-columns: 1fr; } /* Tek sütun */
             #league-table-section { grid-row: auto; margin-top: 50px; } /* Puan durumu alta gelir */
             .filter-section { max-width: 700px; margin-left: auto; margin-right: auto;}
             #announcements-section { max-width: 700px; margin-left: auto; margin-right: auto; grid-row: auto; grid-column: auto; padding-right: 0; } /* Duyurular da alta gelir */
             #match-schedule-section::after { display: none; } /* Dikey çizgi mobil/tablette kalkar */
             #match-schedule-section { padding-right: 0; }
         }
         @media (max-width: 992px) {
             :root { --sidebar-width: 230px; }
             .match-table th, .match-table td { padding: 12px 14px; }
             .league-table th, .league-table td { padding: 12px 6px; }
             .container { padding: 40px 18px; }
             .match-table { min-width: 560px; } /* Azaltıldı */
             #theme-toggle { right: 18px; top: 15px; width: 42px; height: 42px; font-size: 18px;}
             #goToTopBtn { width: 45px; height: 45px; font-size: 20px; right: 18px; bottom: 18px;}
             /* MAÇ TABLOSU SÜTUN GİZLEME */
             .match-table th:last-child,
             .match-table td:last-child {
                 display: none; /* Son sütunu (Yayın & Özet) gizle */
             }
             .match-table { min-width: 500px; } /* Son sütun gidince min-width daha da azalabilir */
         }
         @media (max-width: 768px) {
             :root { --sidebar-width: 220px; }
             body { padding-left: 0; }
             #sidebar { transform: translateX(calc(-1 * var(--sidebar-width))); width: var(--sidebar-width); box-shadow: none; backdrop-filter: none; -webkit-backdrop-filter: none; background-color: var(--bg-sidebar-fallback); }
             body:not(.sidebar-collapsed) #sidebar { backdrop-filter: blur(16px); -webkit-backdrop-filter: blur(16px); background-color: var(--bg-sidebar); box-shadow: 7px 0 35px var(--shadow-color); }
             #sidebar-toggle { left: 0; }
             #main-content { margin-left: 0; }
             body:not(.sidebar-collapsed) { padding-left: 0; }
             body:not(.sidebar-collapsed) #sidebar { transform: translateX(0); }
             body:not(.sidebar-collapsed) #sidebar-toggle { left: var(--sidebar-width); }
             .container { padding: 35px 15px; }
             .stream-area-wrapper, .match-table-wrapper, .league-table-wrapper { width: 100%; }
             /* .match-table min-width 992px altında zaten ayarlandı */
             .league-table { min-width: 400px;} /* Azaltıldı */
             h1 { letter-spacing: 3px; }
             #league-table-section { max-width: 100%; }
         }
         @media (max-width: 480px) {
             :root { --sidebar-width: 200px; }
             h1 { letter-spacing: 2px; font-size: clamp(28px, 7vw, 34px); }
             .logo { max-width: 90px; margin-bottom: 20px; }
             .footer { font-size: 0.8em; padding: 25px 15px; }
             .match-table th, .match-table td { padding: 10px 8px; font-size: 11px;}
             .league-table th, .league-table td { padding: 8px 4px; font-size: 10px; }
             .stream-button { padding: 6px 9px; font-size: 0.8em; gap: 4px;}
             #matchFilter { font-size: 0.9em; padding: 12px 15px 12px 45px; }
             .filter-container i { font-size: 1em; left: 15px; }
             #filter-results-count { font-size: 0.8em; }
             .match-table { min-width: 0; } /* Son sütun gizli olduğu için min-width daha da azalabilir */
             .league-table { min-width: 320px; } /* Azaltıldı */
             h2 { gap: 8px; font-size: clamp(18px, 5.5vw, 24px); }
             h2 i { font-size: 0.8em; }
             .channel-list li a { padding: 10px 12px; gap: 8px; font-size: 0.85em;}
             .channel-list li a i { font-size: 0.9em; }
             #sidebar h3 { font-size: 1.05em; gap: 8px;}
             #theme-toggle { width: 36px; height: 36px; font-size: 15px;}
             #goToTopBtn { width: 38px; height: 38px; font-size: 16px; right: 15px; bottom: 15px;}
             #fullscreen-btn { width: 32px; height: 32px; font-size: 15px; right: 10px; bottom: 10px; }
             #announcements-section h2 { font-size: clamp(18px, 5vw, 22px); }
             .announcements-content p { font-size: 0.95em; }
             /* Puan durumunda daha fazla sütun gizleme (örnek) */
             .league-table th:nth-child(4), /* G */
             .league-table td:nth-child(4),
             .league-table th:nth-child(5), /* B */
             .league-table td:nth-child(5),
             .league-table th:nth-child(6), /* M */
             .league-table td:nth-child(6),
             .league-table th:nth-child(7) { /* Av */
                 display: none;
             }
              .league-table { min-width: 0; } /* Daha fazla sütun gidince min-width kalkabilir */
         }

    </style>
</head>
<body class=""> <aside id="sidebar">
        <h3><i class="fa-solid fa-satellite-dish"></i> Kanallar</h3>
        <ul class="channel-list">
            <li><a href="#" data-channel="bein1"><span class="channel-name"><i class="fa-solid fa-tv"></i> BeinSport 1</span><span class="live-indicator"></span></a></li>
            <li><a href="#" data-channel="bein2"><span class="channel-name"><i class="fa-solid fa-tv"></i> BeinSport 2</span><span class="live-indicator"></span></a></li>
            <li><a href="#" data-channel="bein3"><span class="channel-name"><i class="fa-solid fa-tv"></i> BeinSport 3</span><span class="live-indicator"></span></a></li>
            <li><a href="#" data-channel="bein4"><span class="channel-name"><i class="fa-solid fa-tv"></i> BeinSport 4</span><span class="live-indicator"></span></a></li>
            <li><a href="#" data-channel="bein5"><span class="channel-name"><i class="fa-solid fa-tv"></i> BeinSport 5</span><span class="live-indicator"></span></a></li>
            <li><a href="#" data-channel="ssport1"><span class="channel-name"><i class="fa-solid fa-basketball"></i> S Sport 1</span><span class="live-indicator"></span></a></li>
            <li><a href="#" data-channel="ssport2"><span class="channel-name"><i class="fa-solid fa-basketball"></i> S Sport 2</span><span class="live-indicator"></span></a></li>
            <li><a href="#" data-channel="exxen1"><span class="channel-name"><i class="fa-solid fa-futbol"></i> Exxen Spor 1</span><span class="live-indicator"></span></a></li>
            <li><a href="#" data-channel="tivibu1"><span class="channel-name"><i class="fa-solid fa-film"></i> Tivibu Spor 1</span><span class="live-indicator"></span></a></li>
            <li><a href="#" data-channel="dsmart"><span class="channel-name"><i class="fa-solid fa-volleyball-ball"></i> D-Smart Spor</span><span class="live-indicator"></span></a></li>
            </ul>
    </aside>

    <button id="sidebar-toggle" title="Menüyü Aç/Kapat" aria-label="Menüyü Aç/Kapat" aria-expanded="false"><i class="fa-solid fa-bars"></i></button>

    <button id="theme-toggle" title="Temayı Değiştir" aria-label="Temayı Değiştir"><i class="fa-solid fa-moon"></i><i class="fa-solid fa-sun"></i></button>

    <div id="main-content">
        <div id="loading-indicator">
            <div class="spinner"></div>
            <p>Veriler Hazırlanıyor...</p>
        </div>

        <div class="container">
            <img src="logo.png" alt="Taraftarium24 Logo" class="logo" onerror="this.style.display='none'; console.error('logo.png bulunamadı!');">

            <h1>Taraftarium24</h1>
            <p id="current-date"></p> <div class="stream-area-wrapper">
                <div class="stream-container" id="stream-parent">
                    <iframe id="stream-iframe" allow="fullscreen; encrypted-media; picture-in-picture" loading="eager" src="about:blank" title="Canlı Yayın Ekranı"></iframe>
                    <div class="iframe-loader"><div class="spinner"></div></div>
                </div>
                <button id="fullscreen-btn" title="Tam Ekran" aria-label="Yayını tam ekran yap"><i class="fa-solid fa-expand"></i></button>
            </div>

             <section id="announcements-section" style="width: 100%; max-width: 1200px; margin: 0 auto 35px auto; text-align: left;">
                 <h2 style="text-align: center; font-size: clamp(20px, 4vw, 28px); justify-content: center;">
                     <i class="fa-solid fa-bullhorn"></i> Duyurular
                 </h2>
                 <div class="announcements-content" style="background-color: var(--bg-secondary); padding: 20px 25px; border-radius: 15px; box-shadow: 0 8px 25px var(--shadow-color); border: 1px solid var(--border-color);">
                     <p style="margin: 0 0 10px 0; font-size: 1.05em;">➡️ Yeni S Sport kanalları eklenmiştir! Keyifli seyirler.</p>
                     <p style="margin: 0; font-size: 1.05em; color: var(--text-secondary);">➡️ Yayınlarda sorun yaşarsanız lütfen sayfayı yenileyin.</p>
                     </div>
             </section>

            <div class="tables-container">
                <section id="match-schedule-section">
                    <h2><i class="fa-regular fa-calendar-days"></i> Maç Programı</h2>
                    <div class="filter-section">
                        <div class="filter-container">
                            <i class="fa-solid fa-magnifying-glass"></i>
                            <input type="text" id="matchFilter" placeholder="Takım adı ile filtrele..." aria-label="Maçları takım adına göre filtrele">
                        </div>
                        <div id="filter-results-count" aria-live="polite"></div> </div>
                    <div class="match-table-wrapper">
                        <div class="table-content"> <table class="match-table">
                                <thead>
                                    <tr>
                                        <th>Tarih</th>
                                        <th>Ev Sahibi</th>
                                        <th>Deplasman</th>
                                        <th>Saat</th>
                                        <th>Durum</th>
                                        <th>Yayın & Özet</th>
                                    </tr>
                                </thead>
                                <tbody id="matchTableBody">
                                    </tbody>
                            </table>
                        </div>
                    </div>
                </section>

                <section id="league-table-section">
                    <h2><i class="fa-solid fa-table-list"></i> Süper Lig Puan Durumu</h2>
                    <div class="league-table-wrapper">
                        <div class="table-content"> <table class="league-table">
                                <thead>
                                    <tr>
                                        <th>#</th>
                                        <th>Takım</th>
                                        <th>O</th>
                                        <th>G</th>
                                        <th>B</th>
                                        <th>M</th>
                                        <th>Av</th>
                                        <th>P</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr><td class="rank">1</td><td class="team">Galatasaray</td><td>29</td><td>23</td><td>5</td><td>1</td><td>+42</td><td class="points">74</td></tr>
                                    <tr><td class="rank">2</td><td class="team">Fenerbahçe</td><td>29</td><td>22</td><td>5</td><td>2</td><td>+47</td><td class="points">71</td></tr>
                                    <tr><td class="rank">3</td><td class="team">Samsunspor</td><td>30</td><td>15</td><td>6</td><td>9</td><td>+9</td><td class="points">51</td></tr>
                                    <tr><td class="rank">4</td><td class="team">Eyüpspor</td><td>30</td><td>14</td><td>8</td><td>8</td><td>+16</td><td class="points">50</td></tr>
                                    <tr><td class="rank">5</td><td class="team">Beşiktaş</td><td>29</td><td>13</td><td>9</td><td>7</td><td>+12</td><td class="points">48</td></tr>
                                    <tr><td class="rank">6</td><td class="team">Başakşehir</td><td>29</td><td>13</td><td>6</td><td>10</td><td>+9</td><td class="points">45</td></tr>
                                    <tr><td class="rank">7</td><td class="team">Gaziantep FK</td><td>29</td><td>12</td><td>6</td><td>11</td><td>+1</td><td class="points">42</td></tr>
                                     <tr><td class="rank">...</td><td class="team">...</td><td>...</td><td>...</td><td>...</td><td>...</td><td>...</td><td class="points">...</td></tr>
                                    </tbody>
                            </table>
                        </div>
                    </div>
                </section>
            </div> <div class="footer">
                 <p>© <span id="currentYear"></span> Taraftarium24 | <a href="#" title="Gizlilik Politikası">Gizlilik Politikası</a></p>
            </div>

        </div> </div> <button id="goToTopBtn" title="Yukarı Çık" aria-label="Sayfa başına dön"><i class="fa-solid fa-arrow-up"></i></button>

    <script>
        // --- DOM Elementleri ---
        const body = document.body;
        const sidebar = document.getElementById('sidebar');
        const sidebarToggle = document.getElementById('sidebar-toggle');
        const themeToggle = document.getElementById('theme-toggle');
        const mainContent = document.getElementById('main-content');
        const streamIframe = document.getElementById('stream-iframe');
        const streamParent = document.getElementById('stream-parent');
        const iframeLoader = streamParent.querySelector('.iframe-loader');
        const fullscreenBtn = document.getElementById('fullscreen-btn');
        const channelLinks = document.querySelectorAll('.channel-list a');
        const tableBody = document.getElementById('matchTableBody');
        const matchFilterInput = document.getElementById('matchFilter');
        const currentYearSpan = document.getElementById('currentYear');
        const filterResultsCount = document.getElementById('filter-results-count');
        const goToTopBtn = document.getElementById('goToTopBtn');
        const loadingIndicator = document.getElementById('loading-indicator');
        const currentDateElement = document.getElementById('current-date'); // Tarih elementi

        // --- Veri ---
        // *** 27 NİSAN FB-GS MAÇI KALDIRILDI ***
        const manualMatchData = `
2025-04-18,Hatayspor,Konyaspor,20:00,,Upcoming
2025-04-18,Galatasaray,Bodrum FK,20:00,bein1,Upcoming
2025-04-19,Kasımpaşa,Sivasspor,13:30,,Upcoming
2025-04-19,Adana Demirspor,Trabzonspor,16:00,,Upcoming
2025-04-19,Göztepe,Beşiktaş,19:00,,Upcoming
2025-04-20,Başakşehir,Gaziantep FK,13:30,,Upcoming
2025-04-20,Rizespor,Eyüpspor,16:00,,Upcoming
2025-04-20,Fenerbahçe,Kayserispor,19:00,bein1,Upcoming
2025-04-21,Alanyaspor,Samsunspor,20:00,,Upcoming
        `; // Maç listesi sonu

        let allMatches = [];
        let visibleMatches = [];
        let iframeLoadTimeout;

        // --- Yardımcı Fonksiyonlar ---
        const escapeHTML = (str) => { if (!str) return ''; const p = document.createElement('p'); p.textContent = str; return p.innerHTML; };
        const formatStreamName = (streamId) => { if (!streamId) return '?'; const id = escapeHTML(streamId.trim().toLowerCase()); if (id.startsWith('bein')) return `Bein ${id.slice(4)}`; if (id.startsWith('ssport')) return `S Sport ${id.slice(6)}`; if (id.startsWith('tivibu')) return `Tivibu ${id.slice(6)}`; if (id.startsWith('exxen')) return `Exxen ${id.slice(5)}`; if (id.startsWith('dsmart')) return `D-Smart Spor`; return id.toUpperCase(); };
        const getStatusElement = (status) => { const safeStatus = status ? status.trim().toLowerCase() : 'unknown'; let iconClass = 'fa-regular fa-clock'; let text = 'Yakında'; let statusClass = 'status-upcoming'; if (safeStatus === 'live') { iconClass = 'fa-solid fa-circle fa-beat-fade'; text = 'Canlı'; statusClass = 'status-live'; } else if (safeStatus === 'upcoming') { iconClass = 'fa-regular fa-clock'; text = 'Yakında'; statusClass = 'status-upcoming'; } else if (safeStatus === 'finished') { iconClass = 'fa-solid fa-check-double'; text = 'Bitti'; statusClass = ''; } else { iconClass = 'fa-solid fa-question'; text = 'Bilinmiyor'; statusClass = ''; } return `<span class="${statusClass}"><i class="status-icon ${iconClass}"></i>${text}</span>`; };

        // Zaman farkını formatlar (örn: 1s 30d) - Sadece yakın gelecek için
        const formatTimeDifference = (targetDate) => {
            const now = new Date();
            const diffMs = targetDate - now;
            if (diffMs <= 0) return ''; // Geçmişteyse veya tam şimdiyse gösterme

            const diffHours = Math.floor(diffMs / (1000 * 60 * 60));
            const diffMinutes = Math.floor((diffMs % (1000 * 60 * 60)) / (1000 * 60));

            if (diffHours < 24) { // Sadece 24 saatten az kaldıysa göster
                let result = '(';
                if (diffHours > 0) {
                    result += `${diffHours}s `;
                }
                if (diffMinutes > 0 || diffHours === 0) { // Saati 0 ise veya dk varsa göster
                    result += `${diffMinutes}d`;
                }
                result += ' sonra)';
                 return result.includes('s') || result.includes('d') ? result : ''; // İçinde saat veya dakika yoksa boş döndür
            }
            return ''; // 24 saatten fazla varsa gösterme
        };

        // --- Tema İşlevleri ---
        const setupTheme = () => { const savedTheme = localStorage.getItem('theme') || 'dark'; setTheme(savedTheme); themeToggle.addEventListener('click', () => { const newTheme = body.classList.contains('light-theme') ? 'dark' : 'light'; setTheme(newTheme); }); };
        const setTheme = (themeName) => { body.classList.toggle('light-theme', themeName === 'light'); localStorage.setItem('theme', themeName); };

        // --- Sidebar İşlevleri ---
        const setupSidebar = () => { sidebarToggle.addEventListener('click', () => { const isCollapsed = document.body.classList.toggle('sidebar-collapsed'); sidebarToggle.innerHTML = isCollapsed ? '<i class="fa-solid fa-bars"></i>' : '<i class="fa-solid fa-xmark"></i>'; sidebarToggle.setAttribute('aria-expanded', String(!isCollapsed)); }); document.addEventListener('click', (e) => { if (window.innerWidth <= 768 && !document.body.classList.contains('sidebar-collapsed')) { if (!sidebar.contains(e.target) && e.target !== sidebarToggle && !sidebarToggle.contains(e.target)) { sidebarToggle.click(); } } }); if (window.innerWidth <= 768) { document.body.classList.add('sidebar-collapsed'); sidebarToggle.innerHTML = '<i class="fa-solid fa-bars"></i>'; sidebarToggle.setAttribute('aria-expanded', 'false'); } else { sidebarToggle.innerHTML = '<i class="fa-solid fa-xmark"></i>'; sidebarToggle.setAttribute('aria-expanded', 'true'); } };

        // --- Kanal/Yayın İşlevleri ---
        const setupChannelSwitcher = () => { const lastChannel = localStorage.getItem('lastChannel') || 'bein1'; channelLinks.forEach(link => { link.addEventListener('click', (e) => { e.preventDefault(); const channelId = link.getAttribute('data-channel'); setActiveChannel(channelId); if (window.innerWidth <= 768 && !document.body.classList.contains('sidebar-collapsed')) { sidebarToggle.click(); } }); }); setActiveChannel(lastChannel, true); streamIframe.addEventListener('load', handleIframeLoad); streamIframe.addEventListener('error', handleIframeError); };
        const setActiveChannel = (channelId, forceUpdate = false) => { if (!channelId) return; channelLinks.forEach(l => { l.classList.toggle('active', l.getAttribute('data-channel') === channelId); }); updateIframeSource(channelId); localStorage.setItem('lastChannel', channelId); };

        // --- GÜNCELLENMİŞ FONKSİYON (v3 - Hata Düzeltmesi) ---
        const updateIframeSource = (channelId) => {
            let streamUrl = ''; // URL'yi tutacak değişken

            // Kanal ID'sini kontrol et
            if (channelId === 'bein1') {
                // Eğer kanal 'bein1' ise, özel URL'yi kullan
                streamUrl = 'https://taraftarium-24.com/channel.html?id=yayinstar';
                console.log(`Bein1 için özel URL kullanılıyor: ${streamUrl}`);
            } else {
                // Diğer tüm kanallar için varsayılan URL yapısını kullan
                streamUrl = `https://playertrgb.pages.dev/ch.html?id=${channelId}`;
                console.log(`Varsayılan URL yapısı kullanılıyor: ${streamUrl}`);
            }

            // --- ÖNCEKİ KONTROL KALDIRILDI ---
            // Kaynağı her zaman ayarla, tarayıcı aynıysa zaten cache'den çeker.
            console.log(`Iframe kaynağı ${streamUrl} olarak ayarlanıyor...`);
            showIframeLoader();
            streamIframe.src = streamUrl; // Iframe'in src özelliğini ayarla
            clearTimeout(iframeLoadTimeout); // Önceki zaman aşımını temizle
            // Yeni bir zaman aşımı ayarla (eğer iframe 18 saniyede yüklenmezse loader'ı gizle)
            iframeLoadTimeout = setTimeout(hideIframeLoader, 18000);
        };
        // --- GÜNCELLEME SONU ---

        const showIframeLoader = () => iframeLoader?.classList.add('loading');
        const hideIframeLoader = () => { iframeLoader?.classList.remove('loading'); clearTimeout(iframeLoadTimeout); };
        const handleIframeLoad = hideIframeLoader; const handleIframeError = () => { console.error("Iframe yüklenemedi."); hideIframeLoader(); };
        window.changeStreamFromTable = (streamId) => { if (!streamId) return; const cleanStreamId = escapeHTML(streamId); setActiveChannel(cleanStreamId, true); streamIframe.scrollIntoView({ behavior: 'smooth', block: 'center' }); };

        // --- Tam Ekran İşlevi ---
        const setupFullscreen = () => { if (!fullscreenBtn || !streamParent) return; fullscreenBtn.addEventListener('click', toggleFullscreen); document.addEventListener('fullscreenchange', handleFullscreenChange); document.addEventListener('webkitfullscreenchange', handleFullscreenChange); document.addEventListener('mozfullscreenchange', handleFullscreenChange); document.addEventListener('MSFullscreenChange', handleFullscreenChange); };
        const toggleFullscreen = () => { const elem = streamParent; if (!document.fullscreenElement && !document.webkitFullscreenElement && !document.mozFullScreenElement && !document.msFullscreenElement) { if (elem.requestFullscreen) { elem.requestFullscreen(); } else if (elem.webkitRequestFullscreen) { elem.webkitRequestFullscreen(); } else if (elem.mozRequestFullScreen) { elem.mozRequestFullScreen(); } else if (elem.msRequestFullscreen) { elem.msRequestFullscreen(); } } else { if (document.exitFullscreen) { document.exitFullscreen(); } else if (document.webkitExitFullscreen) { document.webkitExitFullscreen(); } else if (document.mozCancelFullScreen) { document.mozCancelFullScreen(); } else if (document.msExitFullscreen) { document.msExitFullscreen(); } } };
        const handleFullscreenChange = () => { const isFullscreen = !!(document.fullscreenElement || document.webkitFullscreenElement || document.mozFullScreenElement || document.msFullscreenElement); fullscreenBtn.innerHTML = isFullscreen ? '<i class="fa-solid fa-compress"></i>' : '<i class="fa-solid fa-expand"></i>'; fullscreenBtn.title = isFullscreen ? "Tam Ekrandan Çık" : "Tam Ekran"; };

        // --- Maç Tablosu İşlevleri ---
        const setupMatchTable = () => { fetchMatches(); matchFilterInput.addEventListener('input', handleFilter); };
        const fetchMatches = async () => {
            loadingIndicator.classList.remove('hidden');
            tableBody.innerHTML = '';
            filterResultsCount.textContent = '';
            const matchTxtPath = 'mac.txt'; // Gerçek veri kaynağınızın yolu
            let rawMatchData = '';
            try {
                // Veri çekme simülasyonu/gecikmesi
                await new Promise(resolve => setTimeout(resolve, 450));
                // Gerçek fetch isteği (eğer mac.txt varsa)
                // const response = await fetch(matchTxtPath);
                // if (!response.ok) throw new Error(`HTTP ${response.status}`);
                // rawMatchData = await response.text();

                // Şimdilik manuel veriyi kullanalım
                rawMatchData = manualMatchData; // Eğer fetch başarısız olursa veya yoksa manuel veriyi kullan

            } catch (error) {
                console.error("mac.txt alınamadı, manuel veriler kullanılıyor:", error);
                rawMatchData = manualMatchData; // Hata durumunda manuel veriyi kullan
            } finally {
                const parsedMatches = parseMatchData(rawMatchData);
                filterAndPrepareMatches(parsedMatches); // Veriyi filtrele ve hazırla
                renderTable(visibleMatches); // Tabloyu oluştur
                updateLiveIndicators(); // Canlı göstergeleri güncelle
                loadingIndicator.classList.add('hidden'); // Yükleme göstergesini gizle
            }
        };
        const parseMatchData = (textData) => {
            if (!textData || typeof textData !== 'string') return [];
            const lines = textData.trim().split('\n');
            const matches = [];
            lines.forEach((line, index) => {
                const cleanLine = line.trim();
                if (!cleanLine || cleanLine.startsWith('#')) return; // Boş veya yorum satırlarını atla
                const parts = cleanLine.split(',');
                if (parts.length === 6) {
                    matches.push({
                        id: `match-${Date.now()}-${index}`, // Benzersiz ID oluştur
                        date: parts[0]?.trim() || '?',
                        homeTeam: parts[1]?.trim() || 'Ev Sahibi',
                        awayTeam: parts[2]?.trim() || 'Deplasman',
                        time: parts[3]?.trim() || '--:--',
                        stream: parts[4]?.trim() || '', // Kanal bilgisi boş olabilir
                        status: parts[5]?.trim() || 'Upcoming' // Durum bilgisi
                    });
                } else {
                    // console.warn(`Satır ${index + 1} geçersiz format: ${cleanLine}`); // Hatalı format loglaması
                }
            });
            // Maçları önce duruma (Canlı > Yakında > Bitti/Bilinmiyor), sonra tarihe göre sırala
            matches.sort((a, b) => {
                const statusOrder = { live: 1, upcoming: 2, finished: 3, unknown: 4 };
                const statusA = statusOrder[a.status.toLowerCase()] || 4;
                const statusB = statusOrder[b.status.toLowerCase()] || 4;

                if (statusA !== statusB) return statusA - statusB;

                // Durumlar aynıysa tarihe göre sırala
                try {
                    const dateA = new Date(`${a.date}T${a.time || '00:00'}`);
                    const dateB = new Date(`${b.date}T${b.time || '00:00'}`);
                    if (!isNaN(dateA) && !isNaN(dateB)) {
                        return dateA - dateB;
                    }
                } catch (e) { /* Tarih parse hatası olursa sıralamayı değiştirme */ }
                return 0; // Sıralama yapılamazsa veya tarihler aynıysa
            });
            return matches;
        };

        // *** GEÇMİŞ MAÇLARI FİLTRELEME FONKSİYONU ***
        const filterAndPrepareMatches = (parsedMatches) => {
            const now = new Date(); // Şimdiki zamanı al
            // Maçları filtrele
            allMatches = parsedMatches.filter(match => {
                const statusLower = match.status.toLowerCase();

                // 1. Durumu 'finished' olanları direkt filtrele (gösterme)
                if (statusLower === 'finished') {
                    return false;
                }

                // 2. Durumu 'upcoming' olanları kontrol et
                if (statusLower === 'upcoming') {
                    try {
                        // Maçın tam tarih ve saatini oluştur
                        const dateTimeString = `${match.date}T${match.time || '00:00'}:00`;
                        const matchDateTime = new Date(dateTimeString);

                        // Eğer maçın başlangıç zamanı geçerli bir tarihse VE şu andan önceyse,
                        // bu maçı filtrele (gösterme)
                        if (!isNaN(matchDateTime.getTime()) && matchDateTime < now) {
                            // console.log(`Filtrelendi (Geçmiş Upcoming): ${match.homeTeam} vs ${match.awayTeam} - ${dateTimeString}`); // Test için log
                            return false; // *** ÖNEMLİ: Geçmiş 'Upcoming' maçları burada filtreleniyor ***
                        }
                    } catch (e) {
                        // Tarih parse hatası olursa maçı filtreleme (belki format yanlıştır)
                        console.error("Tarih parse hatası:", match, e);
                    }
                }

                // Yukarıdaki koşullara takılmayan (Canlı, Bilinmeyen veya GELECEKTEKİ Upcoming) maçları göster
                return true;
            });
            visibleMatches = [...allMatches]; // Filtrelenmiş listeyi görünür maçlar olarak ayarla
        };


        const renderTable = (matchesToRender) => {
            tableBody.innerHTML = ''; // Tabloyu temizle
            const fragment = document.createDocumentFragment();
            const now = new Date(); // Geri sayım için şimdiki zaman
            let visibleRowCount = 0;

            if (!matchesToRender || matchesToRender.length === 0) {
                // Maç yoksa mesaj göster
                const emptyRow = document.createElement('tr');
                emptyRow.innerHTML = `<td colspan="6" style="text-align:center; padding: 40px; color: var(--text-secondary);"><i class="fa-solid fa-inbox fa-lg" style="margin-right: 8px;"></i> Gösterilecek maç bulunamadı.</td>`;
                fragment.appendChild(emptyRow);
                filterResultsCount.textContent = '0 maç bulundu.';
            } else {
                matchesToRender.forEach((match, index) => {
                    const row = document.createElement('tr');
                    row.id = match.id;
                    row.classList.add('match-row');
                    if (match.status?.toLowerCase() === 'live') { row.classList.add('live'); }

                    let countdownText = '';
                    if (match.status?.toLowerCase() === 'upcoming') {
                        try {
                            const matchDateTime = new Date(`${match.date}T${match.time || '00:00'}:00`);
                            if (!isNaN(matchDateTime.getTime())) {
                                countdownText = formatTimeDifference(matchDateTime);
                            }
                        } catch(e) { /* Hata olursa geri sayım gösterme */ }
                    }

                    row.innerHTML = `
                        <td>${escapeHTML(match.date)}</td>
                        <td><strong>${escapeHTML(match.homeTeam)}</strong></td>
                        <td><strong>${escapeHTML(match.awayTeam)}</strong></td>
                        <td>${escapeHTML(match.time)}<span class="countdown-timer">${countdownText}</span></td>
                        <td>${getStatusElement(match.status)}</td>
                        <td>
                            <div style="display:flex; align-items:center; gap:10px; justify-content: flex-start;">
                                ${match.stream ? `<button class="stream-button" onclick="changeStreamFromTable('${escapeHTML(match.stream)}')"><i class="fa-solid fa-play"></i> ${formatStreamName(match.stream)}</button>` : '-'}
                                <button class="highlights-btn" disabled title="Özetler Mevcut Değil"><i class="fa-solid fa-film"></i></button>
                            </div>
                        </td>`;
                    fragment.appendChild(row);
                    // Satırları animasyonla görünür yap
                    requestAnimationFrame(() => {
                        setTimeout(() => {
                            row.classList.add('visible');
                        }, index * 25); // Animasyon gecikmesi (daha hızlı)
                    });
                    visibleRowCount++;
                });
                 filterResultsCount.textContent = `${visibleRowCount} maç bulundu.`;
            }
             tableBody.appendChild(fragment); // Oluşturulan tüm satırları tabloya ekle
        };

        const handleFilter = (event) => {
            const searchTerm = event.target.value.toLowerCase().trim();
            // Türkçe karakterleri de içeren normalleştirme fonksiyonu
            const normalizeText = (text) => text.normalize("NFD").replace(/[\u0300-\u036f]/g, "").toLowerCase();
            const normalizedSearchTerm = normalizeText(searchTerm);

            const filteredMatches = allMatches.filter(match =>
                normalizeText(match.homeTeam).includes(normalizedSearchTerm) ||
                normalizeText(match.awayTeam).includes(normalizedSearchTerm)
            );
            visibleMatches = filteredMatches; // Görünür maçları güncelle
            renderTable(visibleMatches); // Tabloyu yeniden oluştur
        };

        // --- Canlı Yayın Göstergeleri ---
         const updateLiveIndicators = () => {
             const liveChannels = new Set();
             // Canlı olan tüm maçların kanal ID'lerini topla
             allMatches.forEach(match => {
                 if (match.status?.toLowerCase() === 'live' && match.stream) {
                     liveChannels.add(match.stream.trim().toLowerCase());
                 }
             });
             // Sidebar'daki her link için kontrol et
             channelLinks.forEach(link => {
                 const channelId = link.getAttribute('data-channel')?.trim().toLowerCase();
                 if (channelId) {
                     // Eğer kanal ID'si canlı yayın listesindeyse 'has-live' sınıfını ekle/kaldır
                     link.classList.toggle('has-live', liveChannels.has(channelId));
                 }
             });
         };

        // --- Yukarı Çık Butonu ---
        const setupGoToTop = () => {
            mainContent.addEventListener('scroll', () => {
                // Belirli bir scroll miktarından sonra butonu göster/gizle
                goToTopBtn.classList.toggle('visible', mainContent.scrollTop > 350);
            });
            goToTopBtn.addEventListener('click', () => {
                // Tıklanınca sayfanın başına yumuşakça kaydır
                mainContent.scrollTo({ top: 0, behavior: 'smooth' });
            });
        };

        // --- Güncel Tarih ---
        const displayCurrentDate = () => {
            if (!currentDateElement) return;
            const now = new Date();
            // Tarihi Türkçe ve uzun formatta göster
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            currentDateElement.textContent = now.toLocaleDateString('tr-TR', options);
        };

        // --- Başlangıç ---
        const initializeApp = () => {
            console.log("Taraftarium24 Nexus Başlatılıyor (v14 - Layout/Scroll Düzeltmeleri)...");
            currentYearSpan.textContent = new Date().getFullYear(); // Footer yılı
            displayCurrentDate(); // Üstteki tarihi göster
            setupTheme(); // Tema ayarları
            setupSidebar(); // Sidebar açma/kapama
            setupChannelSwitcher(); // Kanal değiştirme
            setupFullscreen(); // Tam ekran butonu
            setupMatchTable(); // Maç tablosu ve filtreleme
            setupGoToTop(); // Yukarı çık butonu
            console.log("Uygulama başarıyla başlatıldı.");
        };

        // Sayfa tamamen yüklendiğinde uygulamayı başlat
        document.addEventListener('DOMContentLoaded', initializeApp);
    </script>

</body>
</html>
